rules_version = '2';
service cloud.firestore {
	match /databases/{database}/documents {
		match /files/{file} {
			allow get:
				if resource.data.publicAccess
				|| request.auth != null
				&& request.auth.uid == resource.data.author;
			allow list:
				if request.auth != null
				&& request.auth.uid == resource.data.author;

			allow create:
				if request.auth != null
				&& request.auth.uid == request.resource.data.author;
			allow update:
				if request.auth != null
				&& request.auth.uid == resource.data.author
				&& request.auth.uid == request.resource.data.author;
			allow delete:
				if request.auth != null
				&& request.auth.uid == resource.data.author;			
		}
	}
}